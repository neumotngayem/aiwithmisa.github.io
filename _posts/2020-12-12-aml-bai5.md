---
layout: post
title: "[LÃ½ Thuyáº¿t] BÃ i 5 Há»“i quy tuyáº¿n tÃ­nh - Linear Regression"
subtitle: "Loáº¡t bÃ i há»c thuá»™c series AML"
date: 2020-12-12
author: "KyoHB"
header-img: "img/post-bg-aml.jpg"
tags: [AML]
---

Qua 3 bÃ i Ä‘áº§u tiÃªn vá» nhá»¯ng khÃ¡i niá»‡m cÆ¡ báº£n trong ML, chÃºng ta Ä‘Ã£ biáº¿t cÃ³ hai loáº¡i bÃ i toÃ¡n trong há»c giÃ¡m sÃ¡t (Supervised ML) Ä‘Ã³ lÃ : regression vÃ  classification. Trong bÃ i há»c ngÃ y hÃ´m 
nay chÃºng ta sáº½ tÃ¬m hiá»ƒu supervised ML model Ä‘áº§u tiÃªn - Linear Regression, Ä‘Ãºng nhÆ° theo tÃªn gá»i, nÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ giáº£i quyáº¿t cÃ¡c bÃ i toÃ¡n liÃªn quan Ä‘áº¿n regression nhÆ° dá»± Ä‘oÃ¡n tuá»•i tÃ¡c, chiá»u cao, giÃ¡ nhÃ ,...

## Há»“i quy tuyáº¿n tÃ­nh Ä‘Æ¡n giáº£n - Simple Linear Regression

Giáº£ sá»­ trong táº­p dá»¯ liá»‡u (dataset) cá»§a chÃºng ta cÃ³ má»™t biáº¿n Ä‘á»™c láº­p (independent variable) lÃ  x vÃ  má»™t biáº¿n phá»¥ thuá»™c (dependent variable) lÃ  y. Tá»« Ä‘Ã³ chÃºng ta sáº½ thiáº¿t láº­p má»‘i liÃªn há»‡ giá»¯a chÃºng báº±ng má»™t hÃ m sá»‘ tuyáº¿n tÃ­nh (linear function) nhÆ° sau:

$y = w_{0} + w_{1}x$
{:.formula}

Trong hÃ m sá»‘ trÃªn chÃºng ta cÃ³ thá»ƒ Ä‘á»ƒ Ã½ tháº¥y cÃ³ 2 trá»ng sá»‘ (weight) Ä‘Ã³ lÃ  $w_{0}$ vÃ  $w_{1}$. Trong 2 trá»ng sá»‘ nÃ y, $w_{0}$ chÃ­nh lÃ  há»‡ sá»‘ cháº·n (intercept), $w_{1}$ lÃ  há»‡ sá»‘ nghiÃªng (slope) cá»§a Ä‘Æ°á»ng tuyáº¿n tÃ­nh (linear). 
Náº¿u cÃ¡c báº¡n cÃ²n nhá»› trong bÃ i 1 chÃºng ta cÃ³ Ä‘á» cáº­p Ä‘áº¿n model parameter, trong Linear Regression, cÃ¡c trá»ng sá»‘ $w_{0}$ vÃ  $w_{1}$ chÃ­nh lÃ  cÃ¡c model parameter mÃ  ML model cáº§n tÃ¬m trong quÃ¡ trÃ¬nh "há»c".

![]({{ site.baseurl }}/img/in-post/aml/linear-line.jpg)*Source: methods.sagepub.com*
{:.image-caption}

Linear Regression model cÃ³ nhiá»‡m vá»¥ tÃ¬m ra $w_{0}$ vÃ  $w_{1}$ phÃ¹ há»£p (fit) vá»›i táº­p dá»¯ liá»‡u (dataset). NhÆ°ng lÃ m sao Ä‘á»ƒ Linear Regression model biáº¿t Ä‘Æ°á»£c $w_{0}$ vÃ  $w_{1}$ nÃ o lÃ  phÃ¹ há»£p ? ChÃºng ta sáº½ quay láº¡i vá»›i khÃ¡i niá»‡m Ä‘Ã£ Ä‘Æ°á»£c nháº¯c Ä‘áº¿n trong bÃ i 2, hÃ m máº¥t mÃ¡t (loss). HÃ m máº¥t mÃ¡t Ä‘Æ°á»£c sá»­ dá»¥ng trong LR model Ä‘Ã³ lÃ  Residual Sum of Square (RSS), vÃ  Ä‘Æ°á»£c tÃ­nh theo cÃ´ng thá»©c sau:

$RSS = \sum_{1}^{n} (y_{actual} - y_{predict})^{2}$
{:.formula}

Trong cÃ´ng thá»©c trÃªn n chÃ­nh lÃ  sá»‘ cÃ¡ thá»ƒ (instance) trong táº­p dá»¯ liá»‡u (dataset). Pháº§n dÆ° thá»«a (residual) giá»¯a káº¿t quáº£ thá»±c táº¿ vÃ  dá»± Ä‘oÃ¡n cÃ³ thá»ƒ nhÃ¬n tháº¥y má»™t cÃ¡ch trá»±c quan hÆ¡n trong hÃ¬nh váº½ dÆ°á»›i Ä‘Ã¢y:

![]({{ site.baseurl }}/img/in-post/aml/linear-regression-residual.png)*Source: sthda.com*
{:.image-caption}


CÃ¡c gáº¡ch mÃ u Ä‘á» trong Ä‘á»“ thá»‹ trÃªn chÃ­nh cÃ¡c pháº§n dÆ° thá»«a (residual) Ä‘Æ°á»£c biá»ƒu thá»‹ báº±ng hÃ¬nh áº£nh. Khi RSS nhá» nháº¥t, tá»•ng cÃ¡c Ä‘á»™ dÃ i gáº¡ch Ä‘á» nÃ y sáº½ lÃ  ngáº¯n nháº¥t, vÃ  ta sáº½ cÃ³ má»™t Ä‘Æ°á»ng tuyáº¿n tÃ­nh phÃ¹ há»£p nháº¥t (best fit line) vá»›i cÃ¡c cÃ¡ thá»ƒ (instance) cá»§a táº­p dá»± liá»‡u (dataset). Tá»« Ä‘Æ°á»ng há»“i quy tuyáº¿n tÃ­nh (regression line) Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh, chÃºng ta cÃ³ thá»ƒ dá»± Ä‘oÃ¡n giÃ¡ trá»‹ cá»§a biáº¿n phá»¥ thuá»™c (dependent variable) y báº±ng cÃ¡ch Ã¡nh xáº¡ (reflected) giÃ¡ trá»‹ cá»§a biáº¿n khÃ´ng phá»¥ thuá»™c (independent variable) x vÃ o Ä‘Æ°á»ng há»“i quy tuyáº¿n tÃ­nh (regression line).

## Há»“i quy tuyáº¿n tÃ­nh Ä‘a biáº¿n - Multiple Linear Regression

á» pháº§n trÃªn chÃºng ta chá»‰ sá»­ dá»¥ng má»™t biáº¿n khÃ´ng phá»¥ thuá»™c (independent variable) x. Tuy nhiÃªn cÃ¡c bÃ i toÃ¡n trong thá»±c táº¿ khÃ´ng chá»‰ dá»«ng láº¡i á»Ÿ má»™t biáº¿n khÃ´ng phá»¥ thuá»™c (independent variable), vÃ­ dá»¥ nhÆ° giÃ¡ nhÃ  khÃ´ng chá»‰ phá»¥ thuá»™c vÃ o diá»‡n tÃ­ch cá»§a ngÃ´i nhÃ , nÃ³ cÃ²n phá»¥ thuá»™c vÃ o khoáº£ng cÃ¡ch tá»« ngÃ´i nhÃ  Ä‘áº¿n trung tÃ¢m, sá»‘ phÃ²ng ngá»§, sá»‘ nhÃ  vá»‡ sinh,... 
Cáº§n nháº¯c láº¡i má»™t chÃºt kiáº¿n thá»©c chÃºng ta Ä‘Ã£ há»c trong bÃ i 2, Ä‘Ã³ lÃ  cÃ¡c biáº¿n khÃ´ng phá»¥ thuá»™c nÃ y cáº§n Ä‘áº£m báº£o khÃ´ng cÃ³ má»‘i tÆ°Æ¡ng quan vá»›i nhau lá»›n, nháº±m trÃ¡nh xáº£y ra hiá»‡n tÆ°á»£ng cá»™ng tuyáº¿n (collinearity) áº£nh hÆ°á»›ng Ä‘áº¿n Ä‘á»™ chÃ­nh xÃ¡c cá»§a Linear Regression model. Vá»›i viá»‡c cÃ³ thÃªm cÃ¡c biáº¿n khÃ´ng phá»¥ thuá»™c (independent variable) chÃºng ta cáº§n má»Ÿ rá»™ng hÃ m sá»‘ tuyáº¿n tÃ­nh (linear function) ra vá»›i nhiá»u cÃ¡c trá»ng sá»‘ hÆ¡n, bÃ i toÃ¡n khi Ä‘Ã³ Ä‘Æ°á»£c gá»i lÃ  Multiple Linear Regression. HÃ m sá»‘ tuyáº¿n tÃ­nh (linear function) khi Ä‘Ã³ sáº½ nhÆ° sau:


$y = w_{0} + w_{1}x_{1} + w_{2}x_{2} +...+ w_{k}x_{k}$
{:.formula}

Trong Ä‘Ã³ k lÃ  sá»‘ biáº¿n khÃ´ng phá»¥ thuá»™c (independent variable).

## Há»“i quy phi tuyáº¿n tÃ­nh - Polynomial Linear Regression

Khi sá»± phÃ¢n bá»‘ cá»§a cÃ¡c cÃ¡ thá»ƒ trong táº­p dá»¯ liá»‡u mang tÃ­nh phi tuyáº¿n tÃ­nh (nonlinear) chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p biáº¿n Ä‘á»•i vá»›i cÃ¡c biáº¿n khÃ´ng phá»¥ thuá»™c (independent variable) Ä‘á»ƒ chuyá»ƒn LR sang Polynomial Regression nháº±m giÃºp cáº£i thiá»‡n hiá»‡u nÄƒng (performance) cá»§a model. HÃ m sá»‘ Ä‘a thá»©c (polynomial function) Ä‘á»™ (degree) 2 cÃ³ dáº¡ng nhÆ° sau:

$y = w_{0} + w_{1}x\ + w_{2}x^{^{2}}$
{:.formula}

Viá»‡c táº¡o thÃªm má»™t tÃ­nh nÄƒng (feature) $x^{^{2}}$, vÃ´ hÃ¬nh chÃºng giÃºp táº¡o ra sá»± má»™t phi tuyáº¿n tÃ­nh (non linear) cho model. DÃ¹ váº­y vá» báº£n cháº¥t $x^{^{2}}$ Ä‘Æ°á»£c táº¡o ra lÃ  tá»« $x$ nÃªn cÃ¡c trá»ng sá»‘ gáº¯n vá»›i nÃ³ lÃ  $w_{1}$ vÃ  $w_{2}$ váº«n cÃ³ má»‘i quan há»‡ tuyáº¿n tÃ­nh (linear relationship). VÃ¬ lÃ½ do Ä‘Ã³ Polynomial Regression Ä‘Æ°á»£c coi nhÆ° má»™t má»™t trÆ°á»ng há»£p Ä‘áº·c biá»‡t cá»§a Linear Regression.

![]({{ site.baseurl }}/img/in-post/aml/polynomial-regression.png)*Source: javatpoint.com*
{:.image-caption}

ChÃºng ta cÅ©ng cáº§n lÆ°u Ã½ kiá»ƒm tra hiá»‡u nÄƒng (performance) cá»§a Polynomial Regression trong táº­p xÃ¡c nháº­n (validation set) vÃ  táº­p kiá»ƒm tra (testing set) vÃ¬ viá»‡c "uá»‘n cong" theo cÃ¡c cÃ¡ thá»ƒ (instance) á»Ÿ táº­p huáº¥n luyá»‡n (training set) cÃ³ thá»ƒ gÃ¢y ra váº¥n Ä‘á» quÃ¡ vá»«a váº·n (overfit).

## Káº¿t

NhÆ° váº­y trong bÃ i há»c ngÃ y hÃ´m nay chÃºng ta Ä‘Ã£ tÃ¬m hiá»ƒu vá» ML model Ä‘áº§u tiÃªn, Ä‘Ã³ lÃ  Linear Regression model Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c bÃ i toÃ¡n regression. á» bÃ i tiáº¿p theo chÃºng ta sáº½ thá»±c hÃ nh triá»ƒn khai má»™t Linear Regression model báº±ng Python, hÃ£y Ä‘Ã³n Ä‘á»c nhÃ© ğŸ’ª .