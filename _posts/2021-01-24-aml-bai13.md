---
layout: post
title: "[LÃ½ Thuyáº¿t] BÃ i 13 MÃ¡y vector há»— trá»£ - Support Vector Machine"
subtitle: "Loáº¡t bÃ i há»c thuá»™c series AML"
date: 2021-01-24
author: "KyoHB"
header-img: "img/post-bg-aml.jpg"
tags: [AML]
---

Trong bÃ i há»c ngÃ y hÃ´m nay chÃºng ta sáº½ tÃ¬m hiá»ƒu vá» má»™t ML model giÃ¡m sÃ¡t (supervised) cÃ³ thá»ƒ giáº£i quyáº¿t cáº£ bÃ i toÃ¡n phÃ¢n loáº¡i (classification) vÃ  há»“i quy (regression) nhÆ°ng thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong bÃ i toÃ¡n phÃ¢n loáº¡i (classification) hÆ¡n Ä‘Ã³ lÃ  mÃ¡y vector há»— trá»£ - Support vector machine (SVM). SVM báº£n cháº¥t lÃ  má»™t ML model tuyáº¿n tÃ­nh (linear), tuy nhiÃªn chÃºng ta cÃ³ thá»ƒ Ã¡p dá»¥ng phÆ°Æ¡ng phÃ¡p biáº¿n Ä‘á»•i Ä‘á»ƒ sá»­ dá»¥ng SVM cho cÃ¡c bÃ i toÃ¡n phi tuyáº¿n tÃ­nh (non-linear).

## Äá»‹nh nghÄ©a vá» SVM

Nháº¯c láº¡i bÃ i toÃ¡n phÃ¢n loáº¡i (classification) dá»¯ liá»‡u chÃºng ta Ä‘Ã£ Ä‘á» cáº­p trong bÃ i sá»‘ 3 - Logistic Regression. TÆ°Æ¡ng tá»± nhÆ° Logistic Regression, chÃºng ta cáº§n SVM táº¡o ra má»™t Ä‘Æ°á»ng phÃ¢n Ä‘á»‹nh (decision boundary) trÃªn khÃ´ng gian 2 chiá»u hoáº·c má»™t cÃ¡ch tá»•ng quÃ¡t hÆ¡n Ä‘Ã³ lÃ  siÃªu pháº³ng (hyperplane) trÃªn cÃ¡c khÃ´ng gian nhiá»u chiá»u nháº±m phÃ¢n loáº¡i dá»¯ liá»‡u. HÃ¬nh váº½ dÆ°á»›i Ä‘Ã¢y mÃ´ táº£ má»™t siÃªu pháº³ng (hyperplane) giÃºp phÃ¢n loáº¡i (classification) 2 nhÃ³m (class) dá»¯ liá»‡u xanh vÃ  Ä‘á».

![]({{ site.baseurl }}/img/in-post/aml/svm_hyperplane.png)

Tuy nhiÃªn chÃºng ta cÃ³ thá»ƒ tháº¥y ngoÃ i siÃªu pháº³ng (hyperplane) nhÆ° trÃªn chÃºng ta cÅ©ng cÃ³ thá»ƒ váº½ ra Ä‘Æ°á»£c ráº¥t nhiá»u siÃªu pháº³ng (hyperplane) khÃ¡c cÅ©ng cÃ³ thá»ƒ phÃ¢n loáº¡i Ä‘Æ°á»£c dá»¯ liá»‡u nhÆ° hÃ¬nh váº½ dÆ°á»›i Ä‘Ã¢y.

![]({{ site.baseurl }}/img/in-post/aml/svm_multihyperplane.png)

Váº­y siÃªu pháº³ng (hyperplane) nÃ o lÃ  tá»‘i Æ°u nháº¥t ?

Äá»ƒ tráº£ lá»i cho cÃ¢u há»i nÃ y SVM sá»­ dá»¥ng cÃ¡c vector há»— trá»£ (support vector). Vector há»— trá»£ (support vector) lÃ  cÃ¡c cÃ¡ thá»ƒ (instance) gáº§n vá»›i siÃªu pháº³ng (hyperplane) nháº¥t. Theo SVM lá» (margin) giá»¯a 2 vector há»— trá»£ (support vector) á»Ÿ 2 nhÃ³m (class) sáº½ lÃ  yáº¿u tá»‘ quyáº¿t Ä‘á»‹nh Ä‘á»™ tá»‘i Æ°u cá»§a má»™t siÃªu pháº³ng (hyperplane). Má»™t cÃ¡ch trá»±c quan siÃªu pháº³ng (hyperplane) nÃ o cÃ³ lá» (margin) lá»›n nháº¥t thÃ¬ sáº½ lÃ  siÃªu pháº³ng (hyperplane) tá»‘i Æ°u nháº¥t. Do Ä‘Ã³ SVM cÃ²n cÃ³ má»™t tÃªn gá»i khÃ¡c lÃ  Maximum Margin Classification. Cáº§n lÆ°u Ã½ ráº±ng SVM chá»‰ quan tÃ¢m Ä‘áº¿n cÃ¡c vector há»— trá»£ (support vector) cÃ¡c cÃ¡ thá»ƒ khÃ¡c (instance) Ä‘á»u cÃ³ thá»ƒ bá» qua trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng siÃªu pháº³ng (hyperplane). HÃ¬nh dÆ°á»›i Ä‘Ã¢y mÃ´ táº£ lá» (margin) cá»§a má»™t siÃªu pháº³ng (hyperplane).

![]({{ site.baseurl }}/img/in-post/aml/svm_margin.png)

Trong máº·t pháº³ng 2 chiá»u chÃºng ta cÃ³ cÃ´ng thá»©c tÃ­nh khoáº£ng cÃ¡ch tá»« má»™t Ä‘iá»ƒm $N(x_{0}, y_{0})$ Ä‘áº¿n má»™t Ä‘Æ°á»ng tháº³ng $ax+by+c= 0$ lÃ  nhÆ° sau:

$d = \\frac{\|ax_{0}+by_{0}+c\|}{\\sqrt{a^{2}+b^{2}+c^{2}}}$
{:.formula}

Quay trá»Ÿ láº¡i vá»›i SVM, siÃªu pháº³ng (hyperplane) cá»§a chÃºng ta Ä‘Æ°á»£c viáº¿t gá»n thÃ nh $w^{T}x + b$ do Ä‘Ã³ khoáº£ng cÃ¡ch tá»« má»™t cÃ¡ thá»ƒ báº¥t ká»³ Ä‘áº¿n siÃªu pháº³ng (hyperplane) sáº½ nhÆ° sau:

$d = \\frac{\|w^{T}x + b\|}{\\left \\| w \\right \\|_{2}}$
{:.formula}

Trong Ä‘Ã³ $\\left \\| w \\right \\|_{2}$ Ä‘Æ°á»£c gá»i lÃ  norm 2 

XÃ©t trong bÃ i toÃ¡n cÃ³ 2 nhÃ³m (class) lÃ  1 vÃ  -1, khi Ä‘Ã³ khoáº£ng cÃ¡ch tá»« vector há»— trá»£ (support vector) Ä‘áº¿n siÃªu pháº³ng (hyperplane) sáº½ lÃ :

$d = \\frac{1}{\\left \\| w \\right \\|_{2}}$
{:.formula}

Do Ä‘Ã³ margin cá»§a chÃºng ta sáº½ lÃ  $\\frac{2}{\\left \\| w \\right \\|_{2}}$

![]({{ site.baseurl }}/img/in-post/aml/svm_margin_number.png)

BÃ i toÃ¡n tÃ¬m lá» (margin) lá»›n nháº¥t cá»§a chÃºng ta lÃºc nÃ y chÃ­nh lÃ  lÃ  bÃ i toÃ n tÃ¬m $\\left \\| w \\right \\|_{2}$ nhá» nháº¥t.


## Lá» má»m - Soft margin

Trong thá»±c táº¿ dá»¯ liá»‡u thÆ°á»ng khÃ´ng phÃ¢n tÃ¡ch nhau má»™t cÃ¡ch rÃµ rá»‡t, náº¿u chÃºng ta Ã©p SVM pháº£i táº¡o ra siÃªu pháº³ng (hyperplane) má»™t cÃ¡ch cháº·t cháº½ khÃ´ng Ä‘Æ°á»£c phÃ©p sai lá»‡ch má»™t cÃ¡ch cá»©ng nháº¯c (hard margin) nhÆ° trÃªn sáº½ cho ra má»™t siÃªu pháº³ng (hyperplane) háº¹p vÃ´ hÃ¬nh chung lÃ m cho model cá»§a chÃºng ta thiáº¿u Ä‘i tÃ­nh tá»•ng quÃ¡t, quÃ¡ vá»«a váº·n (overfit) vá»›i dá»¯ liá»‡u cá»§a táº­p huáº¥n luyá»‡n (training set). VÃ¬ lÃ½ do Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ ná»›i lá»ng báº³ng cÃ¡ch lÃ m rá»™ng lá» (margin) hÆ¡n má»™t chÃºt, cháº¥p nháº­n nhá»¯ng cÃ¡ thá»ƒ (instance) bá»‹ phÃ¢n loáº¡i sai. HÃ¬nh dÆ°á»›i cho chÃºng ta cÃ¡i nhÃ¬n rÃµ rÃ ng hÆ¡n vá» tÃ­nh hiá»‡u quáº£ khi sá»­ dá»¥ng lá» má»m (soft margin), hÃ¬nh bÃªn trÃ¡i lÃ  siÃªu pháº³ng (hyperplane) Ä‘Æ°á»£c táº¡o ra khi sá»­ dá»¥ng lá» má»m (soft margin), hÃ¬nh bÃªn pháº£i lÃ  siÃªu pháº³ng (hyperplane) Ä‘Æ°á»£c táº¡o ra khi sá»­ dá»¥ng lá» cá»©ng (hard margin).

![]({{ site.baseurl }}/img/in-post/aml/svm_softmargin.jpg)

Äá»ƒ kiá»ƒm soÃ¡t sai xÃ³t cá»§a lá» má»m (soft margin) trong má»©c cho phÃ©p, SVM model sá»­ dá»¥ng Ä‘áº¡i lÆ°á»£ng $C$ biá»ƒu thá»‹ má»©c Ä‘á»™ pháº¡t khi model dá»± Ä‘oÃ¡n sai. Khi $C$ cÃ ng lá»›n, SVM model sáº½ bá»‹ pháº¡t náº·ng hÆ¡n khi dá»± Ä‘oÃ¡n sai vÃ  káº¿t quáº£ sáº½ cho ra má»™t lá» (margin) háº¹p. á» chiá»u ngÆ°á»£c láº¡i khi $C$ cÃ ng nhá», SVM sáº½ cÃ ng dá»… dÃ£i hÆ¡n vÃ  káº¿t quáº£ sáº½ cho ra má»™t lá» (margin) rá»™ng. HÃ¬nh dÆ°á»›i sáº½ cho chÃºng ta tháº¥y sá»± khÃ¡c biá»‡t khi thay Ä‘á»•i $C$.

![]({{ site.baseurl }}/img/in-post/aml/svm_c.png)

# Kernel trick

Vá»›i Ä‘áº·c tÃ­nh siÃªu pháº³ng, SVM model sáº½ gáº·p khÃ³ khÄƒn trong bÃ i toÃ¡n phi tuyáº¿n tÃ­nh (non-linear). Äá»ƒ giáº£i quyáº¿t Ä‘Æ°á»£c váº¥n Ä‘á» nÃ y, má»™t máº¹o (trick) Ä‘Æ°á»£c Ã¡p dá»¥ng báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m kernel (kernel function) Ä‘á»ƒ biáº¿n Ä‘á»•i dá»¯ liá»‡u sang má»™t chiá»u (dimension) cao hÆ¡n tá»« Ä‘Ã³ cÃ³ thá»ƒ phÃ¢n tÃ¡ch má»™t cÃ¡ch tuyáº¿n tÃ­nh (linear) dá»… dÃ ng. Hai hÃ m kernel thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘Ã³ lÃ  Polynomial kernel vÃ  Radial Basis Function (RBF) kernel. HÃ¬nh dÆ°á»›i Ä‘Ã¢y sáº½ minh há»a vá» sá»± tiá»‡n lá»£i trong viá»‡c tÃ¬m kiáº¿m siÃªu pháº³ng (hyperplane) khi chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u tá»« 2 chiá»u (dimension) sang 3 chiá»u (dimension) sá»­ dá»¥ng Polynomial kernel.

![]({{ site.baseurl }}/img/in-post/aml/svm_kernel.png)

## Káº¿t

NhÆ° váº­y qua bÃ i há»c nÃ y chÃºng ta Ä‘Ã£ tÃ¬m hiá»ƒu vá» SVM, má»™t ML cÃ³ khÃ¡ nhiá»u thÃ´ng sá»‘ váº­n hÃ nh (hyperparameter) cÃ³ thá»ƒ lá»±a chá»n Ä‘á»ƒ cho ra má»™t model tá»‘i Æ°u, trong bÃ i tá»›i chÃºng ta sáº½ cÃ¹ng thá»±c hÃ nh triá»ƒn khai xÃ¢y dá»±ng má»™t SVM model báº±ng Python Ä‘á»ƒ xem hiá»‡u nÄƒng cá»§a model nÃ y khi giáº£i quyáº¿t bÃ i toÃ¡n phÃ¢n loáº¡i sáº½ ra sao nhÃ© ğŸ’ª