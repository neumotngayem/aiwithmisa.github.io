---
layout: post
title: "[LÃ½ Thuyáº¿t] BÃ i 2: CÃ¡c bÆ°á»›c cÆ¡ báº£n Ä‘á»ƒ giáº£i quyáº¿t má»™t bÃ i toÃ¡n ML"
subtitle: "Loáº¡t bÃ i há»c thuá»™c series AML"
date: 2020-12-07
author: "KyoHB"
header-img: "img/post-bg-aml.jpg"
tags: [AML]
---

NhÆ° váº­y trong bÃ i 1 chÃºng ta Ä‘Ã£ cÃ¹ng Ä‘iá»ƒm qua nhá»¯ng khÃ¡i niá»‡m Ä‘áº§u tiÃªn vá» ML, Ä‘á»ƒ báº¯t tay giáº£i quyáº¿t bÃ i toÃ¡n báº±ng ML chÃºng ta cáº§n tráº£i qua nhá»¯ng bÆ°á»›c gÃ¬ ?

![]({{ site.baseurl }}/img/in-post/aml/ml-step.png)*Source: houseofbots.com*
{:.image-caption}

## Thu tháº­p dá»¯ liá»‡u (Get Data)

Táº¥t nhiÃªn rá»“i Ä‘á»ƒ giáº£i quyáº¿t Ä‘Æ°á»£c bÃ i toÃ¡n ML chÃºng ta cáº§n pháº£i cÃ³ dá»¯ liá»‡u, vÃ  dá»¯ liá»‡u bao nhiá»u thÃ¬ lÃ  Ä‘á»§ ? KhÃ´ng cÃ³ con sá»‘ chÃ­nh xÃ¡c lÃ  cáº§n pháº£i cÃ³ nhiÃªu bao nhiÃªu dá»¯ liá»‡u nhÆ°ng cháº¯c cháº¯n ráº±ng sá»‘ lÆ°á»£ng cÃ ng nhiá»u thÃ¬ sáº½ cÃ ng tá»‘t (The more the better). Ta sáº½ cÃ³ má»™t cÃ¡i nhÃ¬n Ä‘Ãºng Ä‘áº¯n nháº¥t vá» sá»‘ lÆ°á»£ng dá»¯ liá»‡u lÃ  thiáº¿u hay Ä‘á»§ khi model Ä‘Ã£ Ä‘Æ°á»£c train vÃ  Ä‘Æ°a vÃ o Ä‘Ã¡nh giÃ¡ hiá»‡u nÄƒng (evaluate performance) trÃªn cÃ¡c dá»¯ liá»‡u má»›i (unseen data).

Äá»ƒ thá»±c hÃ nh cÃ¡c ká»¹ nÄƒng ML, chÃºng ta cÃ³ thá»ƒ táº­n dá»¥ng nhá»¯ng nguá»“n dá»¯ liá»‡u (dataset) dá»“i dÃ o tá»« cÃ¡c nguá»“n ná»•i tiáº¿ng nhÆ° Kaggle (Kaggle: Your Home for Data Science), UCI (UCI Machine Learning Repository). Trong chuyÃªn má»¥c AML nÃ y cÃ¡c pháº§n thá»±c hÃ nh cÅ©ng sáº½ láº¥y dá»¯ liá»‡u tá»« cÃ¡c nguá»“n trÃªn.

## Chuáº©n bá»‹ dá»¯ liá»‡u (Data Preparation)

Khi cÃ³ Ä‘Æ°á»£c dá»¯ liá»‡u, chÃºng ta cáº§n pháº£i tiá»n xá»­ lÃ½ (pre-processing) trÆ°á»›c khi tiáº¿n hÃ nh training model. ÄÃ¢y lÃ  giai Ä‘oáº¡n ráº¥t quan trá»ng, nÃ³ giá»‘ng nhÆ° viá»‡c chÃºng ta cáº§n pháº£i cáº¯t, gá»t, rá»­a rau, thá»‹t, cÃ¡ trÆ°á»›c khi Ä‘Æ°a vÃ o ná»“i Ä‘á»ƒ náº¥u. BÆ°á»›c Ä‘áº§u tiÃªn Ä‘á»ƒ tiá»n xá»­ lÃ½ dá»¯ liá»‡u chÃºng ta cáº§n pháº£i khÃ¡m phÃ¡ vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u â€“ Explory Data Analysis (EDA).

Trong EDA chÃºng ta sáº½ khÃ¡m phÃ¡ vÃ  phÃ¢n tÃ­ch nhá»¯ng thÃ´ng tin vá» táº­p dá»¯ liá»‡u (dataset) nhÆ° sá»‘ lÆ°á»£ng cÃ¡ thá»ƒ (instance), sá»‘ biáº¿n (variable), phÃ¢n phá»‘i (distribution) giÃ¡ trá»‹ cá»§a cÃ¡c biáº¿n, má»‘i quan há»‡ giá»¯a cÃ¡c biáº¿n khÃ´ng phá»¥ thuá»™c (independent variable) vÃ  biáº¿n phá»¥ thuá»™c (dependent variable) cÅ©ng nhÆ° kiá»ƒm tra cÃ¡c váº¥n Ä‘á» nhÆ° dá»¯ liá»‡u trá»‘ng (missing values), dá»¯ liá»‡u máº¥t cÃ¢n báº±ng (imbalanced dataset), kiá»ƒm tra cÃ¡c cÃ¡ thá»ƒ ngoáº¡i biÃªn (outlier). Äá»ƒ cÃ³ thá»ƒ nhÃ¬n nháº­n má»™t cÃ¡ch trá»±c quan cÃ¡c váº¥n Ä‘á», khi thá»±c hiá»‡n EDA chÃºng ta sáº½ sá»­ dÅ©ng cÃ¡c biá»ƒu Ä‘á»“ nhÆ° biá»ƒu Ä‘á»“ cá»™t, há»™p (box-plot), phÃ¢n phá»‘i (distribution). KhÃ¡ nhiá»u thuáº­t ngá»¯ má»›i Ä‘Ãºng khÃ´ng, Ä‘á»«ng sá»£, hÃ£y uá»‘ng má»™t ngá»¥m nÆ°á»›c vÃ  chÃºng ta sáº½ Ä‘i vÃ o chi tiáº¿t cá»§a tá»«ng thuáº­t ngá»¯ Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÃªn nhÃ© !

á» pháº§n trÃªn chÃºng ta cÃ³ Ä‘á» cáº­p Ä‘áº¿n biáº¿n khÃ´ng phá»¥ thuá»™c (independent variable) vÃ  biáº¿n phá»¥ thuá»™c (dependent variable) váº­y khÃ´ng phá»¥ thuá»™c vÃ  phá»¥ thuá»™c lÃ  gÃ¬ ? Biáº¿n khÃ´ng phá»¥ thuá»™c (independent variable) chÃ­nh lÃ  cÃ¡c thÃ nh pháº§n giÃºp chÃºng ta dá»± Ä‘oÃ¡n ra biáº¿n phá»¥ thuá»™c (dependent variable). VÃ­ dá»¥ nhÆ° trong bÃ i toÃ¡n dá»± Ä‘oÃ¡n giÃ¡ nhÃ , cÃ¡c biáº¿n khÃ´ng phá»¥ thuá»™c sáº½ lÃ : diá»‡n tÃ­ch, sá»‘ phÃ²ng ngá»§, sá»‘ nhÃ  vá»‡ sinh, khu vá»±c cÃ³ an ninh khÃ´ng, khoáº£ng cÃ¡ch vá»›i trung tÃ¢m thÃ nh phá»‘ vÃ  biáº¿n phá»¥ thuá»™c sáº½ lÃ  giÃ¡ nhÃ . Dá»±a trÃªn cÃ¡c biáº¿n khÃ´ng phá»¥ thuá»™c, chÃºng ta sáº½ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c biáº¿n phá»¥ thuá»™c. Trong giai Ä‘oáº¡n tiá»n xá»­ lÃ½ chÃºng ta cáº§n Ä‘Ã¡nh giÃ¡ má»‘i quan há»‡ giá»¯a cÃ¡c biáº¿n khÃ´ng phá»¥ thuá»™c vÃ  biáº¿n phá»¥ thuá»™c Ä‘á»ƒ xem chÃºng cÃ³ cÃ³ thá»±c sá»± liÃªn quan Ä‘áº¿n nhau khÃ´ng. Äá»ƒ Ä‘Ã¡nh giÃ¡ má»‘i quan há»‡ giá»¯a chÃºng, chÃºng ta sáº½ sá»­ dá»¥ng ma tráº­n tÆ°Æ¡ng quan (correlation matrix).

![]({{ site.baseurl }}/img/in-post/aml/correlation-matrix.jpg)*Source: statology.org*
{:.image-caption}

HÃ¬nh trÃªn lÃ  minh há»a cho má»™t ma tráº­n tÆ°Æ¡ng quan (correlation matrix), cÃ³ thá»ƒ tháº¥y nÃ³ sáº½ lÃ  má»™t ma tráº­n Ä‘á»‘i xá»©ng (symmetric matrix) cÃ³ giÃ¡ trá»‹ tá»« -1 Ä‘áº¿n 1. GiÃ¡ trá»‹ trong ma tráº­n tÆ°Æ¡ng quan (correlation matrix) thá»ƒ hiá»‡n má»±c Ä‘á»™ liÃªn quan giá»¯a cÃ¡c biáº¿n, cÃ ng gáº§n 1 vÃ  -1 thÃ¬ má»©c Ä‘á»™ liÃªn quan cÃ ng cao, náº¿u gáº§n 0 thÃ¬ cÃ¡c biáº¿n Ä‘Ã³ gáº§n nhÆ° khÃ´ng liÃªn quan Ä‘áº¿n nhau. Trong matrix trÃªn cÃ³ thá»ƒ tháº¥y Exam score cÃ³ má»©c Ä‘á»™ liÃªn quan cao theo hÆ°á»›ng thuáº­n nhau (positive relationship) vá»›i Hours spent studying, má»©c Ä‘á»™ tÆ°Æ¡ng quan giá»¯a hai biáº¿n nÃ y lÃ  0.82, Ä‘á»“ng nghÄ©a vá»›i viá»‡c náº¿u Exam score tÄƒng thÃ¬ Hours spent studying cÅ©ng tÄƒng vÃ  ngÆ°á»i láº¡i. Trong khi Ä‘Ã³ Exam score cÅ©ng cho tháº¥y má»©c Ä‘á»™ liÃªn quan vá»›i Hours spent sleeping nhÆ°ng theo hÆ°á»›ng ngá»‹ch nhau (negative relationship), má»©c Ä‘á»™ tÆ°Æ¡ng quan lÃ  -0.22 cho tháº¥y náº¿u Hours spent Sleeping tÄƒng thÃ¬ Exam score giáº£m vÃ  ngÆ°á»£c láº¡i. Äá»‘i vá»›i IQ score, dÃ¹ Hours spent studying cÃ³ tÄƒng hay giáº£m thÃ¬ chÃºng cÅ©ng khÃ´ng nÃ³i lÃªn Ä‘iá»u gÃ¬ vá»›i IQ score, khi chÃºng gáº§n nhÆ° khÃ´ng liÃªn quan Ä‘áº¿n nhau, má»©c Ä‘á»™ tÆ°Æ¡ng quan gáº§n nhÆ° báº±ng 0 (0.08). ChÃºng ta cÃ³ thá»ƒ tháº¥y nhá»¯ng láº­p luáº­n dá»±a trÃªn ma tráº­n tÆ°Æ¡ng quan (correlation matrix) theo Ä‘Ãºng logic thÃ´ng thÆ°á»ng Ä‘Ãºng khÃ´ng. Tá»« ma tráº­n tÆ°Æ¡ng quan (correlation matrix) nÃ y chÃºng ta cÃ³ thá»ƒ Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh, vÃ­ dá»¥ nhÆ° bÃ i toÃ¡n dá»± Ä‘oÃ¡n Ä‘iá»ƒm IQ score cá»§a má»™t ngÆ°á»i, chÃºng ta cÃ³ thá»ƒ loáº¡i bá» Ä‘i cÃ¡c biáº¿n Hours spent studying, Hours spent sleeping vÃ  School rating vÃ  chá»‰ giá»¯ láº¡i biáº¿n Exam score vÃ¬ cÃ¡c biáº¿n trÃªn khÃ´ng cÃ³ sá»± liÃªn quan Ä‘áº¿n biáº¿n phá»¥ thuá»™c (dependent variable) â€“ IQ score vÃ  sáº½ khÃ´ng giÃºp Ã­ch trong quÃ¡ trÃ¬nh há»c cá»§a ML model. Má»™t lÆ°u Ã½ nhá», náº¿u sá»± liÃªn quan giá»¯a biáº¿n phá»¥ thuá»™c (dependent variable) vÃ  biáº¿n khÃ´ng phá»¥ thuá»™c (independent variable) lÃ  má»™t dáº¥u hiá»‡u tá»‘t, thÃ¬ sá»± liÃªn quan giá»¯a cÃ¡c biáº¿n khÃ´ng phá»¥ thuá»™c (independent variable) láº¡i lÃ  má»™t dáº¥u hiáº¿u xáº¥u náº¿u nhÆ° sá»­ dá»¥ng chÃºng Ä‘á»ƒ xÃ¢y dá»±ng regression model. Hiá»‡n tÆ°á»£ng nÃ y Ä‘Æ°á»£c gá»i lÃ  cá»™ng tuyáº¿n (collinearity), nÃ³ sáº½ gÃ¢y ra sá»± máº¥t á»•n Ä‘á»‹nh trong regression model váº­y nÃªn hÃ£y lÆ°u Ã½ Ä‘áº¿n nÃ³ khi xÃ¢y dá»±ng cÃ¡c regression model nhÃ©.

Trong quÃ¡ trÃ¬nh thu tháº­p dá»¯ liá»‡u, viá»‡c má»™t vÃ i giÃ¡ trá»‹ cÃ³ thá»ƒ khÃ´ng Ä‘Æ°á»£c ghi láº¡i dáº«n Ä‘áº¿n tÃ¬nh tráº¡ng thiáº¿u, há»¥t giÃ¡ trá»‹ (missing values).

![]({{ site.baseurl }}/img/in-post/aml/missing-values.png)*Source: medium.com*
{:.image-caption}

GiÃ¡ trá»‹ trá»‘ng (missing values) thÆ°á»ng Ä‘Æ°á»£c biá»ƒu thá»‹ báº±ng kÃ½ hiá»‡u NA (Not available) trong cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh. ThÃ´ng thÆ°á»ng khi thá»±c hiá»‡n EDA chÃºng ta sáº½ váº½ biá»ƒu Ä‘á»“ cá»™t (Bar plot) Ä‘á»ƒ kiá»ƒm tra xem cÃ¡c biáº¿n nÃ o cÃ³ missing values. Náº¿u sá»‘ lÆ°á»£ng giÃ¡ trá»‹ trá»‘ng (missing value) lÃ  ráº¥t nhá» so vá»›i tá»•ng sá»‘ dá»¯ liá»‡u Ä‘ang cÃ³, chÃºng ta cÃ³ thá»ƒ dá»… dÃ ng xÃ³a bá» nhá»¯ng cÃ¡ thá»ƒ (instance) cÃ³ chá»©a missing value. TrÆ°á»ng há»£p sá»‘ dá»¯ liá»‡u cá»§a chÃºng ta lÃ  khÃ¡ Ã­t, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ thay tháº¿ cÃ¡c giÃ¡ trá»‹ trá»‘ng (missing values) báº±ng cÃ¡c giÃ¡ trá»‹ giáº£ táº¡o (synthetic values). CÃ¡c giÃ¡ trá»‹ giáº£ táº¡o nÃ y Ä‘Æ¡n giáº£n cÃ³ thá»ƒ chá»‰ lÃ  giÃ¡ trá»‹ trung bÃ¬nh cá»§a biáº¿n (mean), hoáº·c phá»©c táº¡p hÆ¡n thÃ¬ sáº½ sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p nhÆ° K-Nearest Neighbor (KNN) Ä‘á»ƒ ra má»™t giÃ¡ trá»‹ giáº£ táº¡o chÃ­nh xÃ¡c hÆ¡n vÃ  Ã­t áº£nh hÆ°á»Ÿng Ä‘áº¿n phÃ¢n phá»‘i (distribution) tá»± nhiÃªn cá»§a dá»¯ liá»‡u.

Dá»¯ liá»‡u thu tháº­p Ä‘Æ°á»£c cÅ©ng cÃ³ thá»ƒ xáº£y ra cÃ¡c váº¥n Ä‘á» máº¥t cÃ¢n báº±ng dá»¯ liá»‡u (imbalanced dataset), Ä‘Ã¢y lÃ  váº¥n Ä‘á» vá»›i cÃ¡c bÃ i toÃ¡n classification, vÃ­ dá»¥ chÃºng ta Ä‘ang giáº£i quyáº¿t bÃ i toÃ¡n phÃ¢n loáº¡i gian láº­n (fraud) tháº» tÃ­n dá»¥ng, cÃ³ Ä‘áº¿n 99% dá»¯ liá»‡u lÃ  khÃ´ng gian láº­n vÃ  chá»‰ cÃ³ 1% dá»¯ liá»‡u lÃ  gian láº­n, Ä‘iá»u nÃ y vÃ´ hÃ¬nh chung táº¡o ra cho chÃºng ta má»™t sÆ° thiÃªn vá»‹ (bias) cho model trong quÃ¡ trÃ¬nh training, khi Ä‘Ã³ nÃ³ sáº½ háº§u nhÆ° phÃ¢n loáº¡i táº¥t cáº£ cÃ¡c dá»¯ liá»‡u trong tÆ°Æ¡ng lai lÃ  khÃ´ng gian láº­n, nhÆ° váº­y quáº£ tháº­t lÃ  khÃ´ng tá»‘t Ä‘Ãºng khÃ´ng ! PhÆ°Æ¡ng phÃ¡p Ä‘á»ƒ giáº£i quyáº¿t bÃ i toÃ¡n nÃ y Ä‘Ã³ lÃ  undersampling vÃ  oversampling, váº­y chÃºng lÃ  gÃ¬, hÃ£y xem hÃ¬nh minh há»a dÆ°á»›i Ä‘Ã¢y Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n nhÃ© !

![]({{ site.baseurl }}/img/in-post/aml/over_under.png)*Source: kdnuggets.com*
{:.image-caption}

Náº¿u thá»±c hiá»‡n Undersampling chÃºng ta sáº½ â€œgá»tâ€ bá»›t dá»¯ liá»‡u á»Ÿ nhÃ³m cÃ³ nhiá»u dá»¯ liá»‡u hÆ¡n (majority class) sao cho báº±ng vá»›i nhÃ³m thiá»ƒu sá»‘ (minority class). á» chiá»u ngÆ°á»£c láº¡i Oversampling chÃºng ta sáº½ sao chÃ©p láº¡i dá»¯ liá»‡u cá»§a nhÃ³m thiá»ƒu sá»‘ (minority class) nhiá»u láº§n Ä‘áº¿n khi báº±ng dá»¯ liá»‡u cá»§a nhÃ³m Ä‘a sá»‘ (majority class). CÃ³ thá»ƒ tháº¥y nhÆ°á»£c Ä‘iá»ƒm cá»§a hai phÆ°Æ¡ng phÃ¡p nÃ y, Undersampling sáº½ lÃ m chÃºng ta thiáº¿u há»¥t Ä‘i dá»¯ liá»‡u, trong khi Oversampling náº¿u nhÆ° chá»‰ Ä‘Æ¡n thuáº§n lÃ  sao chÃ©p láº¡i dá»¯ liá»‡u sáº½ lÃ m ML model bá»‹ hiá»‡n tÆ°á»£ng overfit má»™thiá»‡n tÆ°á»£ng mÃ  khi Ä‘Ã³ ML model quÃ¡ vá»«a váº·n (fit) vá»›i dá»¯ liá»‡u training (training dataset) mÃ  khÃ´ng thá»ƒ Ä‘Æ°a ra dá»± Ä‘oÃ¡n chÃ­nh xÃ¡c cho cÃ¡c dá»¯ liá»‡u má»›i (unseen data). Do Ä‘Ã³ khi thá»±c hiá»‡n Oversampling, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p SMOTE (Synthetic Minority Over-sampling Technique) má»™t phÆ°Æ¡ng phÃ¡p táº¡o ra cÃ¡c giÃ¡ trá»‹ giáº£ táº¡o (synthetic values) cho nhÃ³m thiá»ƒu sá»‘ (minority class).

NhÆ° váº­y chÃºng ta Ä‘Ã£ Ä‘iá»ƒm qua 2 bÆ°á»›c Ä‘áº§u tiÃªn khi báº¯t tay vÃ o viá»‡c giáº£i quyáº¿t má»™t bÃ i toÃ¡n báº±ng ML Ä‘Ã³ lÃ  thu tháº­p vÃ  chuáº©n bá»‹ dá»¯ liá»‡u. á» bÃ i tiáº¿p theo chÃºng ta sáº½ tiáº¿p tá»¥c tÃ¬m hiá»ƒu 3 bÆ°á»›c cÃ²n láº¡i nhÃ© ! ğŸ’ª